<!-- wp:html --><br>
<h4 class="slide-title">NOBLE FRIENDS</h4>
<!-- /wp:html -->

<!-- wp:html -->
<hr><hr>
Life improvement comes with the practice of meditation.<hr><hr>We host a daily 20-minute morning meditation practice. This isn't a class or a guided session, but rather a collective opportunity to show up and sit together in silence.
<hr><hr>
No experience is necessary—only the willingness to sit in stillness with others.<hr><hr>
<h4>To RSVP:</h4>
DM @campmx on <a href="https://www.instagram.com/campmx/" target="_blank"><b><u>Instagram</font></b></u></a> or <a href="https://www.facebook.com/campmx.page" target="_blank"><b><u>Facebook</font></b></u></a><hr><hr>

<h4>What to Expect:</h4>
We will begin promptly at 7:30 AM each day. The format is simple:<hr><hr>

•　20 minutes of silent meditation<br>
•　a gentle chime will signal the beginning and end of the sit<br>
•　after the chime, those who need to leave may do so quietly<hr><hr>

<h4>Optional Sharing Circle:</h4>
For those who wish to stay, a space will open for a brief, optional group share. This is an opportunity to speak from your experience of the practice, but there is no pressure to participate.<hr><hr>

<h4>Where:</h4>
CAMP, Calle las Casitas 61 (or 51), Playa Zipolite, 70947 Arroyo Tres, Oaxaca, Mexico <a href="https://maps.app.goo.gl/4GLyPNkCUBTFear68" target="_blank"><b>(<b><u>map</u></b>)</b></a><hr><hr>

<h4>When:</h4>
Every day at 7:30 AM.<hr><hr>

<h4>What to Bring:</h4>
Nothing. Zafus, zabutons, and meditation benches are provided. Chairs are also available.<hr><hr>

<h4>Price:</h4>
Free<hr><hr><hr><hr><hr><hr>

Looking forward to sitting with you.<hr>

<b>CAMP</b> (Centro de Arte, Movimiento y Paz)<hr><hr><hr><hr>

<h4>What is Meditation?</h4>
Meditation is a practice of training the mind, much like you would train your body through physical exercise. It involves techniques to focus your attention and awareness to achieve a state of mental clarity and emotional tranquility. There are numerous forms of meditation, but many share the common goal of helping you to become more present and less reactive to the constant stream of thoughts that often fill our minds. It is not about stopping your thoughts, but rather observing them without judgment.<hr><hr><hr>

<div class="video-wrap">
  <video class="lazy-video" width="500" controls preload="metadata" playsinline webkit-playsinline controlsList="nodownload" data-src="https://camp.mx/wp-content/uploads/khandro.m4v">
  </video>
  <div class="video-placeholder">Loading video...</div>
</div><hr><hr><hr>

<h4>How to meditate.</h4>

<div class="video-wrap">
  <video class="lazy-video" width="500" controls preload="metadata" playsinline webkit-playsinline controlsList="nodownload" data-src="https://camp.mx/wp-content/uploads/meditation.mp4">
  </video>
  <div class="video-placeholder">Loading video...</div>
</div><hr><hr>

<h4>How to stop the monkey mind.</h4>

<div class="video-wrap">
  <video class="lazy-video" width="500" controls preload="metadata" playsinline webkit-playsinline controlsList="nodownload" data-src="https://camp.mx/wp-content/uploads/Moojiji.m4v">
  </video>
  <div class="video-placeholder">Loading video...</div>
</div>

<!-- /wp:html -->

<!-- wp:html --><hr />
<div> </div>

<style>
.video-wrap {
  position: relative;
  display: inline-block;
  max-width: 100%;
  /*background-color: #f0f0f0;*/
  /*border: 1px solid #ddd;*/
  /*border-radius: 4px;*/
}

.video-wrap video {
  display: block;
  width: 100%;
  height: auto;
  pointer-events: auto;
}

.video-placeholder {
  position: absolute;
  inset: 0;
  display: grid;
  place-items: center;
  color: #666;
  font-size: 16px;
  pointer-events: none;
  z-index: -1;
  background-color: rgba(240, 240, 240, 0.9);
}

.lazy-video.loading {
  opacity: 0.7;
}

.lazy-video.loaded + .video-placeholder {
  display: none;
}
</style>

<script>
document.addEventListener('DOMContentLoaded', function() {
  // Function to pause all videos in this post
  function pauseAllVideos() {
    const allVideos = document.querySelectorAll('video');
    allVideos.forEach(video => {
      if (!video.paused) {
        video.pause();
        console.log('Paused video:', video.src || video.querySelector('source')?.src);
      }
    });
  }
  
  // Listen for card close events (backup method)
  const slideElement = document.querySelector('.slide_10');
  if (slideElement) {
    // Use MutationObserver to detect when the slide gets the 'closed' class
    const observer = new MutationObserver(function(mutations) {
      mutations.forEach(function(mutation) {
        if (mutation.type === 'attributes' && mutation.attributeName === 'class') {
          const target = mutation.target;
          if (target.classList.contains('closed')) {
            console.log('Meditation card closed, pausing videos');
            pauseAllVideos();
          }
        }
      });
    });
    
    observer.observe(slideElement, {
      attributes: true,
      attributeFilter: ['class']
    });
  }
  
  // Lazy loading for videos using Intersection Observer
  const lazyVideos = document.querySelectorAll('.lazy-video');
  
  // Ensure essential attributes for Safari
  lazyVideos.forEach(video => {
    video.setAttribute('controls', '');
    video.setAttribute('playsinline', '');
    video.setAttribute('webkit-playsinline', '');
    video.setAttribute('controlsList', 'nodownload');
    video.setAttribute('preload', 'metadata');
    
    // Safari-specific: Ensure video is ready for interaction
    video.addEventListener('loadstart', () => {
      console.log('Video loadstart event fired');
    });
    
    video.addEventListener('canplay', () => {
      console.log('Video can play - Safari controls should be ready');
      // Force show the video controls
      video.controls = true;
    });
  });
  
  if ('IntersectionObserver' in window) {
    const videoObserver = new IntersectionObserver((entries, observer) => {
      entries.forEach(entry => {
        if (!entry.isIntersecting) return;
        
        const video = entry.target;
        if (video.__hydrated) { 
          observer.unobserve(video); 
          return; 
        }
        
        const dataSrc = video.dataset.src;
        if (dataSrc) {
          video.classList.add('loading');
          
          // Safari works best with direct src assignment
          video.src = dataSrc;
          video.removeAttribute('data-src');
          
          // Mark as loaded once metadata is loaded
          video.addEventListener('loadedmetadata', () => {
            video.classList.remove('loading');
            video.classList.add('loaded');
            
            // Safari-specific: Force controls to be interactive
            setTimeout(() => {
              video.controls = true;
              console.log('Safari: Forced controls re-activation for:', video.src);
            }, 100);
          }, { once: true });
          
          // Safari-specific: Add click handler as backup
          video.addEventListener('click', (e) => {
            // Only handle if clicking directly on video, not controls
            if (e.target === video) {
              if (video.paused) {
                video.play();
              } else {
                video.pause();
              }
              console.log('Safari backup click handler triggered');
            }
          });
          
          video.load();
          video.__hydrated = true;
          observer.unobserve(video);
        }
      });
    }, {
      // Load video when it's 100px away from entering viewport
      rootMargin: '100px'
    });
    
    lazyVideos.forEach(video => {
      videoObserver.observe(video);
    });
  } else {
    // Fallback for browsers without IntersectionObserver support
    lazyVideos.forEach(video => {
      const dataSrc = video.dataset.src;
      if (dataSrc) {
        video.src = dataSrc;
        video.removeAttribute('data-src');
        video.classList.add('loaded');
        video.load();
      }
    });
  }
  
  // Pause all videos when leaving page or switching tabs
  function pauseAllOnExit() {
    document.querySelectorAll('video').forEach(video => {
      if (!video.paused && !video.ended) {
        try { video.pause(); } catch(e) {}
      }
    });
  }
  
  document.addEventListener('visibilitychange', () => { 
    if (document.hidden) pauseAllOnExit(); 
  });
  window.addEventListener('pagehide', () => pauseAllOnExit());
});
</script>
