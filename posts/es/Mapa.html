 <!-- wp:html -->
 <style>
    body.map {margin: 0;}
    @media screen and (max-width: 1050px) {
        body.bodycardopened.map header#header .ct-container-fluid>div:first-child {opacity: 1;}
     }

    .slide_10 {background-position: center bottom;}
        
        .map .card.ct-container{margin:0}
        .map .card-content{padding-top:0}
        .map .layer {
          z-index: -1;
          position: absolute;
          top: 0;
          left: 0;
          margin:auto;
          height: auto;
          width: 100%;
        }

.layer {
  position: absolute;
  top: 0;
  left: 0;
  width: 100%;
  height: 100%;
  object-fit: cover;
  display: none;
  z-index: -1;
}

.layer.active {
  display: block;
  z-index: 0;
}
        .outline {
          display: none;
          position: absolute;
          top: 0;
        }

          .slide-show-container {
            display: inline-block;
            height: 100px;
            width: 100px;
            border: black 1px solid;
            background: grey;
          }
          .detail {
            overflow: hidden;
            z-index: 20;
            position: absolute;
            -webkit-touch-callout: none;
            -webkit-tap-highlight-color: transparent;
            -moz-user-select: -moz-none;
            -webkit-user-select: none;
            -ms-user-select: none;
            user-select: none;
/* opacity:0.4;background:blue; */
          }
          #casita-detail {
            top: 29%;
            left: 0;
            width:18%;
            height: 29%;
          }
          #central-detail {
            top: 40%;
            left: 38%;
            width: 17%;
            height: 39%;
          }
          #chozas-detail {
            top: 29%;
            left: 18%;
            width: 19%;
            height: 49%;
          }
          #calle-detail {
            top: 52%;
            left: 58%;
            width: 31%;
            height: 35%;
          }
          #jardin-detail {
            top: 8%;
            left: 71%;
            width: 28%;
            height: 36%;
          }
          .onmouseover-detail:hover{
             cursor: url('https://camp.mx/wp-content/uploads/custom-cursor.png'), auto;
          }
          #focus-point {
            top:0;
            right: 0;
            height:1px;
            width:0;
          }
.map-container {
    position: relative;
    height: 100%;
    width: fit-content;
    margin: 0 auto;
}
img {
    max-height: 100%;
    vertical-align: middle;
max-width:none;
}  
           .map .card.ct-container {
             max-width: 100dvw;
           }
          .map .card-content {
              max-width: 100dvw;
            /*  overflow-x: scroll;*/
          }
   .interactive-map {
    overflow-x: scroll;
    height: 100dvh;
    position: absolute;
    top: 0;
    left: 0;
    display: flex;
    width: 100dvw;
}     
  .map {
           margin: auto;
          }
        
        /* start background video hiding per media query */
            .mobile-background-video {
                 display: none;
            }
            .desktop-background-video {
                 display: block;
            }
        .@media (max-width: 568px) {
            .mobile-background-video {
                 display: block;
            }
            .desktop-background-video {
                 display: none;
            }
          }


@media (min-aspect-ratio: 5550/1600) 
 { 
     /*for browser ratio greater than map image ratio */
  .map-container {
       width: 100%;
       height: auto;
       margin: 0 0;
        }
   .interactive-map {
    overflow-x: hidden;
    overflow-y:hidden;
    height: auto;
    width: 100dvw;
    }
img {
    max-height: auto;
    vertical-align: middle;
    max-width: 100%;
    } 
 }
@media (min-aspect-ratio: 2570/1600) 
 { 
     /*for browser ratio greater than map image ratio */
  .map-container {
       width: 100%;
       height: auto;
       margin: 0 0;
        }
   .interactive-map {
    overflow-x: hidden;
    overflow-y: scroll;
    height: auto;
    width: 100dvw;
    }
img {
    max-height: auto;
    vertical-align:middle;
    max-width: 100%;
    } 
} 
</style>
<div class="interactive-map" ID="imap">
<div class="map-container">
  <img id="central-down-1" class="map layer" src="https://camp.mx/wp-content/uploads/02-central-down-1.jpg" alt="Map" />
  <img id="central-down-2" class="map layer" src="https://camp.mx/wp-content/uploads/03-central-down-2.jpg" alt="Map" />
  <img id="central-down-3" class="map layer" src="https://camp.mx/wp-content/uploads/04-central-down-3.jpg" alt="Map" />
  <img id="chozas-down-1" class="map layer" src="https://camp.mx/wp-content/uploads/05-chozas-down-1.jpg" alt="Map" />
  <img id="chozas-down-2" class="map layer" src="https://camp.mx/wp-content/uploads/01-start-palapas.jpg" alt="Map" />
  <img id="casita-down-1" class="map layer" src="https://camp.mx/wp-content/uploads/06-casa-down-1.jpg" alt="Map" />
  <img id="casita-down-2" class="map layer" src="https://camp.mx/wp-content/uploads/07-casa-down-2.jpg" alt="Map" />
  <img id="calle-down-1" class="map layer" src="https://camp.mx/wp-content/uploads/08-calle-down-1.jpg" alt="Map" />
  <img id="calle-down-2" class="map layer" src="https://camp.mx/wp-content/uploads/09-calle-down-2.jpg" alt="Map" />
  <img id="calle-down-3" class="map layer" src="https://camp.mx/wp-content/uploads/10-calle-down-3.jpg" alt="Map" />
  <img id="jardin-down-1" class="map layer" src="https://camp.mx/wp-content/uploads/11-foro-down-1.jpg" alt="Map" />
  <img id="jardin-down-2" class="map layer" src="https://camp.mx/wp-content/uploads/12-foro-down-2.jpg" alt="Map" />
  <img id="jardin-down-3" class="map layer" src="https://camp.mx/wp-content/uploads/13-foro-down-3.jpg" alt="Map" />
  <img id="jardin-down-4" class="map layer" src="https://camp.mx/wp-content/uploads/14-foro-down-4.jpg" alt="Map" />
  <img id="map" class="map active" src="https://camp.mx/wp-content/uploads/01-start-palapas.jpg" alt="Map" /> 
  <div id="central-detail" class="detail onmouseover-detail"> </div>
  <div id="casita-detail" class="detail onmouseover-detail"> </div>
  <div id="chozas-detail" class="detail onmouseover-detail"> </div>
  <div id="calle-detail" class="detail onmouseover-detail"> </div>
  <div id="jardin-detail" class="detail onmouseover-detail"> </div>
  <div id="cosina-detail" class="detail onmouseover-detail" style="top:65%;left:29%;width:10%;height:15%;"></div>
  <div id="noclick1" class ="detail" style="top:28%;left:65%;width:21%;height:28%;" onclick="return false;"></div>
  <div id="noclick2" class="detail" style="top:46%;left:29%;width:10%;height:20%;" onclick="return false;"></div>

<div id="focus-point" class="detail"> </div>
<div id="mapExit1" class="detail mapExit onmouseover-detail" style="top:10%;left:0%;width:68%;height:20%;opacity:0.1;xbackground:blue;"></div>
<div id="mapExit2" class="detail mapExit onmouseover-detail" style="bottom:0;left:0%;width:74%;height:20%;opacity:0.1;xbackground:blue;"></div>
<div id="mapExit3" class="detail mapExit onmouseover-detail" style="top:30%;left:0%;width:7%;height:55%;opacity:0.1;xbackground:blue;"></div>
<div id="mapExit4" class="detail mapExit onmouseover-detail" style="top:33%;right:0%;width:7%;height:60%;opacity:0.1;xbackground:blue;"></div>
</div></div>
<script>
     document.addEventListener("DOMContentLoaded", function () {
  const mapSection = document.querySelector("#mapa");
  const mapTitle = document.querySelector("#mapa .card-header h2");

  if (!mapSection || !mapTitle) return;

  const observer = new IntersectionObserver((entries) => {
    entries.forEach((entry) => {
      if (entry.isIntersecting && !hasOpenedMap) {
        mapTitle.click();
        observer.unobserve(mapSection); 
      }
    });
  }, {
    threshold: 0.5
  });

  observer.observe(mapSection);
});
    let currentLayer = undefined

    function closeMap(e)
     {
      e.preventDefault();
      e.stopPropagation();
      console.log('Closing map:');
      //document.querySelector("#mapa .card-header h2").click();
      document.querySelector("#mapa .card-header").click();
    }

    for (let i = 1; i < 9; i++) {
    const mapExit = document.getElementById("mapExit"+i);
     if(mapExit) {
           console.log("-----Adding mapExit",i);
           mapExit.addEventListener('click', closeMap);
                 }
    }
function addExitListeners() {
  const mapExits = document.querySelectorAll(".mapExit");

  mapExits.forEach((map) => {
     map.addEventListener('click', closeMap); 
  })
  console.log("maps...")
}
function clickOutside(event, ele, cb) {
  // Si el click fue en un elemento .mapExit, no hacemos nada
  if (event.target.classList.contains('mapExit')) return;

  if (!ele.contains(event.target)) {
    if (currentLayer) {
      currentLayer.style.zIndex = -1;
    }
    currentLayer = undefined;
    event.preventDefault();
    removeAllClickListeners();
    setAllClickListeners();
    cb();
    document.removeEventListener('click', handleClickOutside);
  }
}

    function onClickOutside(event, ele, cb) {
    document.addEventListener('click', handleClickOutside = (event) => clickOutside(event, ele, cb));
    }

    function openDetail(event, element, mapIds, prevMapId) {
      let currentMapIndex = 0
      let nextMapId = mapIds[currentMapIndex]
      let nextNextMapId = mapIds[currentMapIndex + 1]
      let nextNextNextMapId = mapIds[currentMapIndex + 2]
      let map = document.querySelector("#mapa")
      let nextLayer = document.querySelector("#" + nextMapId)
      // if(!nextLayer){closeCards();return;}
      nextLayer.style.zIndex = 0
      nextLayer.classList.add("active");
      if (currentLayer) {
          currentLayer.classList.remove("active");
          currentLayer.style.zIndex = -1
       }
      currentLayer = nextLayer;
      if (prevMapId) {
        let prevLayer = document.querySelector("#" + prevMapId)
        prevLayer.style.zIndex = -1
        document.removeEventListener("click", handleClickOutside)
      } else {
        try {
          document.removeEventListener("click", handleClickOutside)
        } catch {
          console.log("handleClickOutside is not defined")
        }
      }
      if (nextNextMapId) {   // this means there are more layers to go
        let prevLayerId = mapIds.shift() // remove and save the current map in order to change its z-index back to -1
        setClickListeners(element, mapIds, prevLayerId)
        onClickOutside(event, element, function(){
          nextLayer.style.zIndex = -1
        })
      } else {
        // this means we are in the final layer
        try {
            element.addEventListener("click", function() {
              if (currentLayer) {
                currentLayer.style.zIndex = -1
              }
              removeAllClickListeners()
              document.removeEventListener("click", handleClickOutside)
              setAllClickListeners()
            })

        } catch {
          console.log("handleClickOutside is not defined")
        }
        onClickOutside(event, element, function(){
          nextLayer.style.zIndex = -1
        })
      }
    }
    function setClickListeners(element, mapIds, prevMapId=undefined) {
      element.addEventListener("click", handleOpenDetail = (event) => openDetail(event, element, mapIds, prevMapId),{once: true})
    }
    const map = document.querySelector("#mapa")
    function setAllClickListeners() {
      const casitaDetail = document.querySelector("#casita-detail")
      const centralDetail = document.querySelector("#central-detail")
      const chozasDetail = document.querySelector("#chozas-detail")
      const calleDetail = document.querySelector("#calle-detail")
      const jardinDetail = document.querySelector("#jardin-detail")
      const cosinaDetail = document.querySelector("#cosina-detail")

      setClickListeners(casitaDetail, ["casita-down-1", "casita-down-2"])
      setClickListeners(centralDetail, ["central-down-1", "central-down-2", "central-down-3"])
      setClickListeners(chozasDetail, ["chozas-down-1", "chozas-down-2"])
      setClickListeners(calleDetail, ["calle-down-1", "calle-down-2", "calle-down-3"])
      setClickListeners(jardinDetail, ["jardin-down-1", "jardin-down-2", "jardin-down-3", "jardin-down-4"])
      setClickListeners(cosinaDetail, ["central-down-1", "central-down-2", "central-down-3"])
      setClickListeners(document.querySelector("#mapExit1"), [])   
        addExitListeners(); 
}
    function removeAllClickListeners() {
      let clickableElements = document.getElementsByClassName("detail")
      for (let element of clickableElements) {
        // copy and replacing element in order to remove listeners with certainty
        let newElement = element.cloneNode(true)
        element.parentNode.replaceChild(newElement, element)
      }
      document.removeEventListener("click", handleClickOutside)
    }

    setAllClickListeners()
  </script>
<!-- /wp:html -->